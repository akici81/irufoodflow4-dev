(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[509],{7168:function(e,t,a){Promise.resolve().then(a.bind(a,6376))},6376:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var r=a(7821),s=a(8078),l=a(5561),i=a(7951),n=a(4786);let d=Array.from({length:10},(e,t)=>"".concat(t+1,". Hafta"));function o(){let{yetkili:e,yukleniyor:t}=(0,i.a)("/alisveris-listelerim");if(t)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center text-gray-400",children:"Y\xfckleniyor..."});if(!e)return null;let[o,c]=(0,s.useState)(null),[m,u]=(0,s.useState)(""),[x,h]=(0,s.useState)([]),[p,b]=(0,s.useState)([]),[g,f]=(0,s.useState)(""),[y,j]=(0,s.useState)("1. Hafta"),[v,N]=(0,s.useState)(""),[k,w]=(0,s.useState)({}),[S,_]=(0,s.useState)({}),[C,L]=(0,s.useState)(null),[A,I]=(0,s.useState)({}),[z,T]=(0,s.useState)("liste-olustur"),[E,D]=(0,s.useState)(null),[O,F]=(0,s.useState)({}),[R,M]=(0,s.useState)({});(0,s.useRef)({});let[K,H]=(0,s.useState)(!1),[q,U]=(0,s.useState)([]),[P,Y]=(0,s.useState)(""),[Z,B]=(0,s.useState)(1),[J,G]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{let e=localStorage.getItem("aktifKullaniciId");if(!e)return;c(Number(e));let{data:t}=await n.O.from("kullanicilar").select("ad_soyad, username, dersler").eq("id",e).single();if(!t)return;u(t.ad_soyad||t.username);let{data:a}=await n.O.from("dersler").select("*").order("kod");h((a||[]).filter(e=>(t.dersler||[]).includes(e.id)));let{data:r}=await n.O.from("urunler").select("*");b((r||[]).map(e=>{var t;return{id:e.id,urunAdi:e.urun_adi,marka:e.marka,fiyat:e.fiyat,olcu:e.olcu,kategori:e.kategori,stok:null!==(t=e.stok)&&void 0!==t?t:0}}).sort((e,t)=>e.urunAdi.localeCompare(t.urunAdi,"tr")));let{data:s}=await n.O.from("siparisler").select("*").eq("ogretmen_id",e),l={};(s||[]).forEach(e=>{if(!l[e.ders_id]){var t;l[e.ders_id]={dersId:e.ders_id,dersAdi:e.ders_adi,dersKodu:(null===(t=e.ders_adi)||void 0===t?void 0:t.split(" - ")[0])||"",ogretmenAdi:e.ogretmen_adi,olusturmaTarihi:e.tarih,haftalar:{}}}l[e.ders_id].haftalar[e.hafta]=e.urunler||[]}),I(l)})()},[]),(0,s.useEffect)(()=>{if(!g||!A[g]){w({}),_({});return}w(Object.fromEntries((A[g].haftalar[y]||[]).map(e=>[e.urunId,e.miktar]))),_({})},[g,y,A]);let X=(e,t)=>{L({tip:e,metin:t}),setTimeout(()=>L(null),3500)},V=x.find(e=>e.id===g),Q=p.filter(e=>!v||e.urunAdi.toLowerCase().includes(v.toLowerCase())||e.marka.toLowerCase().includes(v.toLowerCase())),W=e=>{let t=e.toLowerCase();return"kg"===t||"l"===t?{serbest:!0,baslangic:0,adim:0}:"g"===t||"ml"===t?{serbest:!1,baslangic:50,adim:50}:{serbest:!1,baslangic:1,adim:1}},$=(e,t)=>{if(t){let{baslangic:t}=W(e.olcu);w(a=>({...a,[e.id]:t})),W(e.olcu).serbest&&_(t=>({...t,[e.id]:""}))}else w(t=>{let a={...t};return delete a[e.id],a}),_(t=>{let a={...t};return delete a[e.id],a})},ee=(e,t)=>{if(et(t)){_(a=>({...a,[e]:t}));let a=parseFloat(t.replace(",","."));w(t=>({...t,[e]:a}))}else console.warn("Invalid float input for kilograms")},et=e=>{let t=parseFloat(e.replace(",","."));return!isNaN(t)&&isFinite(t)&&t>=0},ea=e=>{let{adim:t,baslangic:a}=W(e.olcu),r=k[e.id]||a;w(a=>({...a,[e.id]:Math.round((r+t)*1e3)/1e3}))},er=e=>{let{adim:t,baslangic:a}=W(e.olcu),r=Math.round(((k[e.id]||a)-t)*1e3)/1e3;r<=0?w(t=>{let a={...t};return delete a[e.id],a}):w(t=>({...t,[e.id]:r}))},es=(e,t)=>{let a=Math.round(1e3*t)/1e3;a<=0?w(t=>{let a={...t};return delete a[e],a}):w(t=>({...t,[e]:a}))},el=Object.entries(k).filter(e=>{let[,t]=e;return t>0}).map(e=>{let[t,a]=e,r=p.find(e=>e.id===t);return r?{urunId:t,urunAdi:r.urunAdi,marka:r.marka,miktar:a,olcu:r.olcu,birimFiyat:r.fiyat,toplam:r.fiyat*a}:null}).filter(Boolean),ei=el.reduce((e,t)=>e+t.toplam,0),en=async()=>{if(!g){X("hata","\xd6nce ders se\xe7in.");return}if(0===q.length){let{data:e}=await n.O.from("receteler").select("id, ad, kategori, porsiyon").eq("aktif",!0).order("ad");U(e||[])}Y(""),B(1),H(!0)},ed=async()=>{if(!P){X("hata","Re\xe7ete se\xe7in.");return}if(Z<1){X("hata","\xd6ğrenci sayısı en az 1 olmalı.");return}G(!0);let{data:e}=await n.O.from("recete_malzemeleri").select("*").eq("recete_id",P);if(!e||0===e.length){X("hata","Bu re\xe7etede malzeme tanımlanmamış."),G(!1);return}let t={...k},a=0;for(let r of e){let e=Math.round(r.miktar_kisi*Z*1e3)/1e3,s=p.find(e=>e.urunAdi.toLowerCase().includes(r.urun_adi.toLowerCase())||r.urun_adi.toLowerCase().includes(e.urunAdi.toLowerCase()));s&&(t[s.id]=(t[s.id]||0)+e,a++)}w(t),H(!1),G(!1),X("basari","".concat(a,"/").concat(e.length," malzeme listeye eklendi. Eşleşmeyenler manuel eklenebilir."))},eo=async()=>{if(!g){X("hata","Lutfen ders secin.");return}if(0===el.length){X("hata","En az bir urun secin.");return}if(!o||!V)return;let{data:e}=await n.O.from("siparisler").select("id").eq("ogretmen_id",o).eq("ders_id",g).eq("hafta",y).single();e?await n.O.from("siparisler").update({urunler:el,genel_toplam:ei}).eq("id",e.id):await n.O.from("siparisler").insert({ogretmen_id:o,ogretmen_adi:m,ders_id:g,ders_adi:"".concat(V.kod," - ").concat(V.ad),hafta:y,urunler:el,genel_toplam:ei,tarih:new Date().toLocaleDateString("tr-TR"),durum:"bekliyor"}),I(e=>{var t;return{...e,[g]:{...e[g]||{dersId:g,dersAdi:V.ad,dersKodu:V.kod,ogretmenAdi:m,olusturmaTarihi:new Date().toLocaleDateString("tr-TR"),haftalar:{}},haftalar:{...(null===(t=e[g])||void 0===t?void 0:t.haftalar)||{},[y]:el}}}}),X("basari","".concat(y," listesi kaydedildi!"))},ec=async e=>{let t=A[e];if(!t)return;let r=await Promise.all([a.e(382),a.e(181)]).then(a.bind(a,4723)),s=r.utils.book_new();d.forEach(e=>{let a=t.haftalar[e]||[],l=[["".concat(t.dersKodu," - ").concat(t.dersAdi," MALZEME TALEP LISTESI"),"","","","","","",""],["","","","","","","",""],["Sira no","Urun","Marka","Miktar","Olcu","B.Fiyat","Toplam"],...a.map((e,t)=>[t+1,e.urunAdi,e.marka,e.miktar,e.olcu,e.birimFiyat,e.toplam])],i=r.utils.aoa_to_sheet(l);i["!cols"]=[{wch:8},{wch:35},{wch:20},{wch:10},{wch:8},{wch:12},{wch:12}],r.utils.book_append_sheet(s,i,e)});let l=[["".concat(t.dersKodu," - ").concat(t.dersAdi),"",""],["Ogretmen: ".concat(t.ogretmenAdi),"",""],["","",""],["Hafta","Urun Sayisi","Toplam Tutar (TL)"]],i=0;d.forEach(e=>{let a=t.haftalar[e]||[],r=a.reduce((e,t)=>e+t.toplam,0);i+=r,l.push([e,a.length,r>0?r:0])}),l.push(["","",""]),l.push(["GENEL TOPLAM","",i]);let n=r.utils.aoa_to_sheet(l);n["!cols"]=[{wch:15},{wch:15},{wch:20}],r.utils.book_append_sheet(s,n,"Genel Ozet"),r.writeFile(s,"".concat(t.dersKodu,"_Malzeme_Talep_Listesi.xlsx"))},em=e=>{let t=A[e];if(!t)return;let a='<!DOCTYPE html><html><head><meta charset="UTF-8"><style>body{font-family:Arial,sans-serif;font-size:11px}.sayfa{page-break-after:always;padding:20px}.baslik{text-align:center;font-size:13px;font-weight:bold;border:2px solid #8B0000;padding:10px;margin-bottom:8px}table{width:100%;border-collapse:collapse}th{background:#8B0000;color:white;padding:6px 8px;font-size:10px}td{padding:5px 8px;border-bottom:1px solid #eee;font-size:10px}</style></head><body>';d.forEach(e=>{let r=t.haftalar[e]||[];a+='<div class="sayfa"><div class="baslik">'.concat(t.dersKodu," - ").concat(t.dersAdi,"<br>MALZEME TALEP LISTESI - ").concat(e,"</div><table><thead><tr><th>Sira</th><th>Urun</th><th>Marka</th><th>Miktar</th><th>Olcu</th><th>Toplam</th></tr></thead><tbody>"),0===r.length?a+='<tr><td colspan="6" style="text-align:center;color:#999;">Bu hafta icin urun girilmemis.</td></tr>':r.forEach((e,t)=>{a+="<tr><td>".concat(t+1,"</td><td>").concat(e.urunAdi,"</td><td>").concat(e.marka||"-","</td><td>").concat(e.miktar,"</td><td>").concat(e.olcu,"</td><td>").concat(e.toplam>0?e.toplam.toFixed(2)+" TL":"-","</td></tr>")}),a+="</tbody></table></div>"}),a+="</body></html>";let r=window.open("","_blank");r&&(r.document.write(a),r.document.close(),r.focus(),setTimeout(()=>{r.print()},500))},eu=async e=>{let t=x.find(t=>t.id===e);if(!t)return;let r=await Promise.all([a.e(382),a.e(181)]).then(a.bind(a,4723)),s=r.utils.book_new();d.forEach(e=>{let t=r.utils.aoa_to_sheet([["urunId","urunAdi","marka","miktar","olcu","birimFiyat","toplam"],["","Domates","Pınar",2,"kg",15,30],["","Zeytinyağı","Komili",500,"ml",.05,25]]);t["!cols"]=[{wch:10},{wch:30},{wch:20},{wch:10},{wch:8},{wch:12},{wch:12}],r.utils.book_append_sheet(s,t,e)}),r.writeFile(s,"".concat(t.kod,"_Sablon.xlsx"))},ex=async(e,t)=>{let r=x.find(t=>t.id===e);if(r&&o){M(t=>({...t,[e]:!0}));try{let s=await t.arrayBuffer(),l=await Promise.all([a.e(382),a.e(181)]).then(a.bind(a,4723)),i=l.read(s,{type:"array"});for(let t of d){let a=i.Sheets[t];if(!a)continue;let s=l.utils.sheet_to_json(a,{header:1}).slice(1).filter(e=>e[1]);if(0===s.length)continue;let d=s.map(e=>{let t=parseFloat(String(e[3]).replace(",","."))||0,a=parseFloat(String(e[5]).replace(",","."))||0;return{urunId:String(e[0]||""),urunAdi:String(e[1]||""),marka:String(e[2]||""),miktar:t,olcu:String(e[4]||""),birimFiyat:a,toplam:parseFloat((t*a).toFixed(2))}}),c=d.reduce((e,t)=>e+t.toplam,0),{data:u}=await n.O.from("siparisler").select("id").eq("ogretmen_id",o).eq("ders_id",e).eq("hafta",t).single();u?await n.O.from("siparisler").update({urunler:d,genel_toplam:c}).eq("id",u.id):await n.O.from("siparisler").insert({ogretmen_id:o,ogretmen_adi:m,ders_id:e,ders_adi:"".concat(r.kod," - ").concat(r.ad),hafta:t,urunler:d,genel_toplam:c,tarih:new Date().toLocaleDateString("tr-TR"),durum:"bekliyor"}),I(a=>{var s;return{...a,[e]:{...a[e]||{dersId:e,dersAdi:r.ad,dersKodu:r.kod,ogretmenAdi:m,olusturmaTarihi:new Date().toLocaleDateString("tr-TR"),haftalar:{}},haftalar:{...(null===(s=a[e])||void 0===s?void 0:s.haftalar)||{},[t]:d}}}})}X("basari","".concat(r.kod," şablon verisi başarıyla y\xfcklendi!"))}catch(e){console.error("Şablon y\xfckleme hatası:",e),X("hata","Şablon y\xfcklenirken hata oluştu. Dosya formatını kontrol edin.")}finally{M(t=>({...t,[e]:!1})),F(t=>{let a={...t};return delete a[e],a})}}},eh=e=>{let t=A[e];return t?d.filter(e=>(t.haftalar[e]||[]).length>0).length:0};return(0,r.jsxs)(l.Z,{title:"Alisveris Listelerim",subtitle:"10 haftalik malzeme talep listesi olusturun",children:[(0,r.jsxs)("div",{className:"max-w-7xl space-y-5",children:[C&&(0,r.jsx)("div",{className:"text-sm rounded-xl px-4 py-3 border font-medium ".concat("basari"===C.tip?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-red-50 text-red-600 border-red-200"),children:C.metin}),(0,r.jsx)("div",{className:"flex gap-2 items-center",children:[{key:"liste-olustur",label:"Liste Olustur"},{key:"listelerim",label:"Listelerim ve Indir"}].map(e=>(0,r.jsx)("button",{onClick:()=>T(e.key),className:"px-5 py-3 rounded-xl text-sm font-semibold transition ".concat(z===e.key?"bg-red-700 text-white":"bg-white border border-gray-200 text-gray-600 hover:bg-gray-50"),children:e.label},e.key))}),"liste-olustur"===z&&(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsx)("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm p-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-medium text-gray-700 block mb-2",children:"Ders *"}),(0,r.jsxs)("select",{value:g,onChange:e=>{f(e.target.value),j("1. Hafta")},className:"w-full border rounded-xl px-4 py-3 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-red-500 ".concat(g?"border-gray-200":"border-red-300"),children:[(0,r.jsx)("option",{value:"",children:"DERS SECINIZ..."}),x.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.kod," - ",e.ad]},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-medium text-gray-700 block mb-2",children:"Hafta Secimi"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:d.map(e=>{var t;let a=g&&((null===(t=A[g])||void 0===t?void 0:t.haftalar[e])||[]).length>0;return(0,r.jsxs)("button",{onClick:()=>j(e),className:"px-3 py-1.5 rounded-lg text-xs font-medium transition border ".concat(y===e?"bg-red-700 text-white border-red-700":a?"bg-emerald-100 text-emerald-700 border-emerald-200":"bg-gray-100 text-gray-500 border-gray-200"),children:[e.replace(". Hafta",".")," ",a&&y!==e?"v":""]},e)})})]})]})}),(0,r.jsxs)("div",{className:"flex gap-5",children:[(0,r.jsx)("div",{className:"flex-1 bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden",children:(0,r.jsxs)("div",{className:"px-6 py-4 border-b border-gray-100 flex items-center justify-between",children:[(0,r.jsxs)("h2",{className:"font-semibold text-gray-800 text-sm",children:["Urun Havuzu — ",y]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:en,className:"bg-amber-500 hover:bg-amber-600 text-white text-xs font-semibold px-3 py-2 rounded-xl transition whitespace-nowrap",children:"\uD83C\uDF7D Re\xe7eteden Ekle"}),(0,r.jsx)("input",{value:v,onChange:e=>N(e.target.value),placeholder:"Urun ara...",className:"border border-gray-200 rounded-xl px-4 py-2 text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-red-500 w-48"})]}),(0,r.jsxs)("div",{className:"mx-4 mt-4 mb-1 bg-blue-50 border border-blue-100 rounded-xl px-4 py-3",children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-blue-700 mb-2",children:"Miktar Giris Rehberi"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-1.5 text-xs",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"font-mono bg-white border border-blue-200 px-1.5 py-0.5 rounded text-blue-800 whitespace-nowrap",children:"Kg / L"}),(0,r.jsxs)("span",{className:"text-gray-500",children:["Istediginiz degeri elle girin — orn: ",(0,r.jsx)("b",{children:"0,100"})," \xb7 ",(0,r.jsx)("b",{children:"1,500"})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"font-mono bg-white border border-blue-200 px-1.5 py-0.5 rounded text-blue-800 whitespace-nowrap",children:"G / Ml"}),(0,r.jsxs)("span",{className:"text-gray-500",children:["+ / - ile ",(0,r.jsx)("b",{children:"50'ser"})," artir/azalt"]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"font-mono bg-white border border-blue-200 px-1.5 py-0.5 rounded text-blue-800 whitespace-nowrap",children:"Adet"}),(0,r.jsxs)("span",{className:"text-gray-500",children:["+ / - ile ",(0,r.jsx)("b",{children:"1'er"})," artir/azalt"]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"font-mono bg-white border border-blue-200 px-1.5 py-0.5 rounded text-blue-800 whitespace-nowrap",children:"Paket / Kutu"}),(0,r.jsxs)("span",{className:"text-gray-500",children:["+ / - ile ",(0,r.jsx)("b",{children:"1'er"})," artir/azalt"]})]})]})]}),0===p.length?(0,r.jsx)("div",{className:"py-16 text-center text-gray-400 text-sm",children:"Urun havuzu bos."}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-50 border-b border-gray-100 text-left",children:[(0,r.jsx)("th",{className:"px-4 py-3 w-10 text-xs font-semibold text-gray-500",children:"SEC"}),(0,r.jsx)("th",{className:"px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"URUN"}),(0,r.jsx)("th",{className:"px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"MARKA"}),(0,r.jsx)("th",{className:"px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"B.FIYAT"}),(0,r.jsx)("th",{className:"px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"MIKTAR"}),(0,r.jsx)("th",{className:"px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"TOPLAM"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-50",children:Q.map(e=>{var t;let a=e.id in k,s=null!==(t=k[e.id])&&void 0!==t?t:0,l=W(e.olcu);return(0,r.jsxs)("tr",{className:"transition-colors ".concat(a?"bg-red-50":"hover:bg-gray-50"),children:[(0,r.jsx)("td",{className:"px-4 py-3",children:(0,r.jsx)("input",{type:"checkbox",checked:a,onChange:t=>$(e,t.target.checked),className:"w-4 h-4 accent-red-600 cursor-pointer"})}),(0,r.jsxs)("td",{className:"px-4 py-3",children:[(0,r.jsx)("p",{className:"font-medium text-gray-800",children:e.urunAdi}),e.kategori&&(0,r.jsx)("p",{className:"text-xs text-gray-400",children:e.kategori}),e.stok>0?(0,r.jsxs)("p",{className:"text-xs text-emerald-600 font-medium",children:["Depoda: ",e.stok," ",e.olcu]}):(0,r.jsx)("p",{className:"text-xs text-gray-400",children:"Depoda stok yok"})]}),(0,r.jsx)("td",{className:"px-4 py-3 text-gray-500",children:e.marka||"-"}),(0,r.jsx)("td",{className:"px-4 py-3 text-gray-700 font-medium",children:e.fiyat>0?"".concat(e.fiyat.toLocaleString("tr-TR",{minimumFractionDigits:2})," TL/").concat(e.olcu):"-"}),(0,r.jsx)("td",{className:"px-4 py-3",children:a?l.serbest?(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("input",{type:"text",inputMode:"decimal",value:void 0!==S[e.id]?S[e.id]:s>0?String(s).replace(".",","):"",placeholder:"orn: 1,500",onChange:t=>ee(e.id,t.target.value),className:"w-24 border rounded-lg px-2 py-1.5 text-sm text-center focus:outline-none focus:ring-2 focus:ring-red-500 ".concat(s>0?"border-gray-300":"border-red-300 bg-red-50 placeholder-red-300")}),(0,r.jsx)("span",{className:"text-xs font-medium text-gray-500",children:e.olcu})]}):(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{type:"button",onClick:()=>er(e),className:"w-7 h-7 flex items-center justify-center bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-600 font-bold text-sm transition",children:"-"}),(0,r.jsx)("input",{type:"number",value:s||"",step:l.adim,min:l.baslangic,onChange:t=>es(e.id,Number(t.target.value)),className:"w-14 border border-gray-200 rounded-lg px-1 py-1 text-sm text-center focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,r.jsx)("span",{className:"text-xs text-gray-400",children:e.olcu}),(0,r.jsx)("button",{type:"button",onClick:()=>ea(e),className:"w-7 h-7 flex items-center justify-center bg-red-100 hover:bg-red-200 rounded-lg text-red-700 font-bold text-sm transition",children:"+"})]}):(0,r.jsx)("span",{className:"text-gray-300",children:"-"})}),(0,r.jsx)("td",{className:"px-4 py-3 font-semibold text-gray-800",children:a&&s>0&&e.fiyat>0?"".concat((e.fiyat*s).toLocaleString("tr-TR",{minimumFractionDigits:2})," TL"):"-"})]},e.id)})})]})})]})}),(0,r.jsx)("div",{className:"w-72 flex-shrink-0",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm p-5 sticky top-4 space-y-4",children:[(0,r.jsxs)("h3",{className:"font-semibold text-gray-800 text-sm",children:[y," Ozeti",(0,r.jsxs)("span",{className:"ml-2 text-xs font-normal text-gray-400",children:["(",el.length," urun)"]})]}),0===el.length?(0,r.jsx)("p",{className:"text-gray-400 text-xs text-center py-4",children:"Henuz urun secilmedi."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"space-y-1.5 max-h-60 overflow-y-auto",children:el.map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-start text-xs py-1.5 border-b border-gray-50",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-800",children:e.urunAdi}),(0,r.jsxs)("p",{className:"text-gray-400",children:[e.miktar," ",e.olcu]})]}),(0,r.jsx)("span",{className:"text-gray-600 font-medium ml-2",children:e.toplam>0?"".concat(e.toplam.toFixed(2)," TL"):"-"})]},e.urunId))}),(0,r.jsxs)("div",{className:"border-t border-gray-200 pt-3 flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"font-semibold text-gray-700",children:"Hafta Toplami"}),(0,r.jsxs)("span",{className:"font-bold text-red-700",children:[ei.toLocaleString("tr-TR",{minimumFractionDigits:2})," TL"]})]})]}),(0,r.jsxs)("button",{type:"button",onClick:eo,disabled:!g,className:"w-full bg-red-700 hover:bg-red-800 text-white text-sm font-semibold py-3 rounded-xl transition disabled:opacity-40",children:[y," Listesini Kaydet"]})]})})]})]}),"listelerim"===z&&(0,r.jsx)("div",{className:"space-y-5",children:0===x.length?(0,r.jsx)("div",{className:"bg-white rounded-2xl border border-gray-200 p-16 text-center text-gray-400 text-sm",children:"Atanmis ders bulunamadi."}):x.map(e=>{let t=A[e.id],a=eh(e.id),s=t?d.reduce((e,a)=>e+(t.haftalar[a]||[]).reduce((e,t)=>e+t.toplam,0),0):0;return(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-6 py-5 flex items-center justify-between border-b border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-xs font-bold bg-red-100 text-red-700 px-2.5 py-1 rounded-lg",children:e.kod}),(0,r.jsx)("h3",{className:"font-bold text-gray-800",children:e.ad})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:[a,"/10 hafta"]}),s>0&&(0,r.jsxs)("p",{className:"text-sm font-bold text-red-700",children:[s.toLocaleString("tr-TR",{minimumFractionDigits:2})," TL"]})]}),t&&a>0?(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>ec(e.id),className:"bg-emerald-600 hover:bg-emerald-700 text-white text-sm font-semibold px-4 py-2.5 rounded-xl transition",children:"Excel"}),(0,r.jsx)("button",{onClick:()=>em(e.id),className:"bg-red-700 hover:bg-red-800 text-white text-sm font-semibold px-4 py-2.5 rounded-xl transition",children:"PDF"}),(0,r.jsx)("button",{onClick:()=>eu(e.id),className:"bg-blue-600 hover:bg-blue-700 text-white text-sm font-semibold px-4 py-2.5 rounded-xl transition",title:"Doldurulabilir Excel şablonu indir",children:"Şablon İndir"}),(0,r.jsxs)("label",{className:"flex items-center gap-1 text-sm font-semibold px-4 py-2.5 rounded-xl transition cursor-pointer ".concat(R[e.id]?"bg-gray-200 text-gray-400":"bg-amber-500 hover:bg-amber-600 text-white"),title:"Doldurduğun şablonu y\xfckle",children:[R[e.id]?"Y\xfckleniyor…":"Excel Y\xfckle",(0,r.jsx)("input",{type:"file",accept:".xlsx",className:"hidden",disabled:R[e.id],onChange:t=>{var a;let r=null===(a=t.target.files)||void 0===a?void 0:a[0];r&&ex(e.id,r),t.target.value=""}})]})]}):(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsx)("button",{onClick:()=>{f(e.id),T("liste-olustur")},className:"text-sm text-red-600 font-medium hover:underline",children:"Liste oluştur →"}),(0,r.jsx)("button",{onClick:()=>eu(e.id),className:"bg-blue-600 hover:bg-blue-700 text-white text-sm font-semibold px-3 py-2 rounded-xl transition",title:"Doldurulabilir Excel şablonu indir",children:"Şablon İndir"}),(0,r.jsxs)("label",{className:"flex items-center gap-1 text-sm font-semibold px-3 py-2 rounded-xl transition cursor-pointer ".concat(R[e.id]?"bg-gray-200 text-gray-400":"bg-amber-500 hover:bg-amber-600 text-white"),title:"Doldurduğun şablonu y\xfckle",children:[R[e.id]?"Y\xfckleniyor…":"Şablon ↑",(0,r.jsx)("input",{type:"file",accept:".xlsx",className:"hidden",disabled:R[e.id],onChange:t=>{var a;let r=null===(a=t.target.files)||void 0===a?void 0:a[0];r&&ex(e.id,r),t.target.value=""}})]})]})]})]}),(0,r.jsx)("div",{className:"px-6 py-4",children:(0,r.jsx)("div",{className:"grid grid-cols-5 lg:grid-cols-10 gap-2",children:d.map(a=>{let s=(null==t?void 0:t.haftalar[a])||[],l=s.reduce((e,t)=>e+t.toplam,0);return(0,r.jsxs)("button",{onClick:()=>{f(e.id),j(a),T("liste-olustur")},className:"p-2 rounded-xl border text-center text-xs transition ".concat(s.length>0?"bg-emerald-50 border-emerald-200 text-emerald-700":"bg-gray-50 border-gray-200 text-gray-400"),children:[(0,r.jsx)("p",{className:"font-bold",children:a.replace(". Hafta",".")}),(0,r.jsx)("p",{className:"text-xs mt-0.5",children:s.length>0?"".concat(l.toLocaleString("tr-TR",{maximumFractionDigits:0})," TL"):"-"})]},a)})})})]},e.id)})})]}),K&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-gray-800",children:"\uD83C\uDF7D Re\xe7eteden Ekle"}),(0,r.jsx)("button",{onClick:()=>H(!1),className:"text-gray-400 hover:text-gray-600 text-xl font-bold",children:"✕"})]}),(0,r.jsxs)("div",{className:"p-6 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-medium text-gray-700 block mb-1",children:"Re\xe7ete Se\xe7in"}),(0,r.jsxs)("select",{value:P,onChange:e=>Y(e.target.value),className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-amber-500",children:[(0,r.jsx)("option",{value:"",children:"-- Re\xe7ete se\xe7in --"}),q.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.ad," (",e.kategori,")"]},e.id))]}),0===q.length&&(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Hen\xfcz re\xe7ete eklenmemiş. Re\xe7ete Havuzu'ndan ekleyebilirsiniz."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-medium text-gray-700 block mb-1",children:"\xd6ğrenci Sayısı"}),(0,r.jsx)("input",{type:"number",min:1,value:Z,onChange:e=>B(Number(e.target.value)),className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-amber-500"})]}),(0,r.jsxs)("div",{className:"bg-amber-50 border border-amber-100 rounded-xl px-4 py-3 text-xs text-amber-700",children:["Re\xe7etedeki malzemeler, \xf6ğrenci sayısıyla \xe7arpılarak mevcut listeye ",(0,r.jsx)("strong",{children:"eklenir"}),". \xdcr\xfcn havuzunda eşleşen \xfcr\xfcnler otomatik işaretlenir."]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-1",children:[(0,r.jsx)("button",{onClick:()=>H(!1),className:"flex-1 border border-gray-300 text-gray-700 text-sm font-medium py-2.5 rounded-xl hover:bg-gray-50 transition",children:"İptal"}),(0,r.jsx)("button",{onClick:ed,disabled:J||!P,className:"flex-1 bg-amber-500 hover:bg-amber-600 text-white text-sm font-semibold py-2.5 rounded-xl transition disabled:opacity-50",children:J?"Ekleniyor...":"Listeye Ekle"})]})]})]})})]})}},5561:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var r=a(7821),s=a(4233),l=a(168),i=a(8078),n=a(4786);let d={admin:[{name:" Ana Sayfa",path:"/admin"},{name:" \xdcr\xfcn Havuzu",path:"/urun-havuzu"},{name:" Re\xe7ete Havuzu",path:"/receteler"},{name:" Kullanıcılar",path:"/kullanicilar"},{name:" Dersler",path:"/dersler"},{name:" Alışveriş Listeleri",path:"/siparisler"},{name:" Sipariş Y\xf6netimi",path:"/siparis-yonetimi"}],ogretmen:[{name:" Ana Sayfa",path:"/ogretmen"},{name:" \xdcr\xfcn Havuzu",path:"/urun-havuzu"},{name:" Re\xe7ete Havuzu",path:"/receteler"},{name:" Alışveriş Listelerim",path:"/alisveris-listelerim"},{name:" Siparişlerim",path:"/siparislerim"},{name:" Talep Oluştur",path:"/talep"}],satin_alma:[{name:" Ana Sayfa",path:"/satin"}],stok:[{name:" Ana Sayfa",path:"/stok"}],bolum_baskani:[{name:" Ana Sayfa",path:"/bolum-baskani"},{name:" Ders Y\xf6netimi",path:"/dersler"}]};function o(e){var t;let{children:a,title:o,subtitle:c}=e,m=(0,l.usePathname)(),u=(0,l.useRouter)(),[x,h]=(0,i.useState)(null),[p,b]=(0,i.useState)(!1);if((0,i.useEffect)(()=>{(async()=>{let e=localStorage.getItem("aktifKullaniciId");if(!e){u.push("/");return}let{data:t,error:a}=await n.O.from("kullanicilar").select("id, username, ad_soyad, role").eq("id",e).single();if(a||!t){u.push("/");return}h(t)})()},[u]),!x)return null;let g=null!==(t=d[x.role])&&void 0!==t?t:[],f=(x.ad_soyad||x.username).split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase();return(0,r.jsxs)("div",{className:"min-h-screen flex bg-gray-100",children:[(0,r.jsx)("button",{onClick:()=>b(!p),className:"lg:hidden fixed top-4 right-4 z-50 bg-red-700 text-white p-3 rounded-lg shadow-lg",children:""}),p&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden",onClick:()=>b(!1)}),(0,r.jsxs)("aside",{className:"w-64 bg-white border-r border-gray-200 flex flex-col shadow-sm flex-shrink-0 fixed lg:static h-screen z-40 transition-transform duration-300 ".concat(p?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:[(0,r.jsx)("div",{className:"px-6 py-5 border-b border-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-red-700 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,r.jsx)("span",{className:"text-white text-xs font-bold",children:"İR\xdc"})}),(0,r.jsx)("span",{className:"font-bold text-gray-800",children:"İR\xdcFoodFlow"})]})}),(0,r.jsx)("nav",{className:"flex-1 px-3 py-4 space-y-0.5",children:g.map(e=>{let t=m===e.path;return(0,r.jsx)(s.default,{href:e.path,className:"flex items-center px-4 py-2.5 rounded-xl text-sm transition-all ".concat(t?"bg-red-50 text-red-700 font-semibold":"text-gray-500 hover:bg-gray-100 hover:text-gray-800"),children:e.name},e.path)})}),(0,r.jsxs)("div",{className:"px-4 py-4 border-t border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)("div",{className:"w-9 h-9 bg-red-700 rounded-full flex items-center justify-center flex-shrink-0",children:(0,r.jsx)("span",{className:"text-white text-xs font-bold",children:f})}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-800 truncate",children:x.ad_soyad||x.username}),(0,r.jsx)("p",{className:"text-xs text-gray-400",children:x.role})]})]}),(0,r.jsx)("button",{onClick:()=>{localStorage.removeItem("aktifKullaniciId"),localStorage.removeItem("role"),localStorage.removeItem("username"),u.push("/")},className:"w-full text-sm text-red-600 hover:text-red-700 font-medium py-2 rounded-xl hover:bg-red-50 transition",children:"\xc7ıkış Yap"})]})]}),(0,r.jsxs)("main",{className:"flex-1 flex flex-col overflow-auto pt-16 lg:pt-0",children:[o&&(0,r.jsxs)("div",{className:"bg-red-700 text-white px-10 py-7 flex-shrink-0",children:[c&&(0,r.jsx)("p",{className:"text-red-300 text-xs font-medium uppercase tracking-widest mb-1",children:c}),(0,r.jsx)("h1",{className:"text-2xl font-bold",children:o})]}),(0,r.jsx)("div",{className:"flex-1 p-8",children:a})]})]})}},7951:function(e,t,a){"use strict";a.d(t,{a:function(){return i}});var r=a(8078),s=a(168);let l={"/admin":["admin"],"/kullanicilar":["admin"],"/dersler":["admin","bolum_baskani"],"/siparisler":["admin"],"/siparis-yonetimi":["admin"],"/urun-havuzu":["admin","ogretmen"],"/receteler":["admin","ogretmen"],"/bolum-baskani":["admin","bolum_baskani"],"/ogretmen":["admin","ogretmen"],"/alisveris-listelerim":["admin","ogretmen"],"/siparislerim":["admin","ogretmen"],"/talep":["admin","ogretmen"],"/satin":["admin","satin_alma"],"/stok":["admin","stok"]};function i(e){let t=(0,s.useRouter)(),[a,i]=(0,r.useState)(!1),[n,d]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let a=localStorage.getItem("aktifKullaniciId"),r=localStorage.getItem("role");if(!a||!r){t.replace("/");return}let s=l[e];if(!s){i(!0),d(!1);return}s.includes(r)?(i(!0),d(!1)):t.replace({admin:"/admin",ogretmen:"/ogretmen",satin_alma:"/satin",stok:"/stok",bolum_baskani:"/bolum-baskani"}[r]||"/")},[e,t]),{yetkili:a,yukleniyor:n}}},4786:function(e,t,a){"use strict";a.d(t,{O:function(){return r}});let r=(0,a(5674).eI)("https://dyqbddyenmrzjjhkperf.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR5cWJkZHllbm1yempqaGtwZXJmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE4NzU1MjcsImV4cCI6MjA4NzQ1MTUyN30.D83dK9y-GkVLYmfon94afTNGaffiZ1S1TCNy5Ug-Io4")}},function(e){e.O(0,[135,233,115,205,744],function(){return e(e.s=7168)}),_N_E=e.O()}]);