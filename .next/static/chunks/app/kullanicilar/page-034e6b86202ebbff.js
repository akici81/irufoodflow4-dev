(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[211],{4810:function(e,a,s){Promise.resolve().then(s.bind(s,9107))},5561:function(e,a,s){"use strict";s.d(a,{Z:function(){return o}});var t=s(7821),l=s(4233),r=s(168),n=s(8078),i=s(4786);let d={admin:[{name:" Ana Sayfa",path:"/admin"},{name:" \xdcr\xfcn Havuzu",path:"/urun-havuzu"},{name:" Re\xe7ete Havuzu",path:"/receteler"},{name:" Kullanıcılar",path:"/kullanicilar"},{name:" Dersler",path:"/dersler"},{name:" Alışveriş Listeleri",path:"/siparisler"},{name:" Sipariş Y\xf6netimi",path:"/siparis-yonetimi"}],ogretmen:[{name:" Ana Sayfa",path:"/ogretmen"},{name:" \xdcr\xfcn Havuzu",path:"/urun-havuzu"},{name:" Re\xe7ete Havuzu",path:"/receteler"},{name:" Alışveriş Listelerim",path:"/alisveris-listelerim"},{name:" Siparişlerim",path:"/siparislerim"},{name:" Talep Oluştur",path:"/talep"}],satin_alma:[{name:" Ana Sayfa",path:"/satin"}],stok:[{name:" Ana Sayfa",path:"/stok"}],bolum_baskani:[{name:" Ana Sayfa",path:"/bolum-baskani"},{name:" Ders Y\xf6netimi",path:"/dersler"}]};function o(e){var a;let{children:s,title:o,subtitle:c}=e,m=(0,r.usePathname)(),x=(0,r.useRouter)(),[u,h]=(0,n.useState)(null),[p,b]=(0,n.useState)(!1);if((0,n.useEffect)(()=>{(async()=>{let e=localStorage.getItem("aktifKullaniciId");if(!e){x.push("/");return}let{data:a,error:s}=await i.O.from("kullanicilar").select("id, username, ad_soyad, role").eq("id",e).single();if(s||!a){x.push("/");return}h(a)})()},[x]),!u)return null;let g=null!==(a=d[u.role])&&void 0!==a?a:[],y=(u.ad_soyad||u.username).split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase();return(0,t.jsxs)("div",{className:"min-h-screen flex bg-gray-100",children:[(0,t.jsx)("button",{onClick:()=>b(!p),className:"lg:hidden fixed top-4 right-4 z-50 bg-red-700 text-white p-3 rounded-lg shadow-lg",children:""}),p&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden",onClick:()=>b(!1)}),(0,t.jsxs)("aside",{className:"w-64 bg-white border-r border-gray-200 flex flex-col shadow-sm flex-shrink-0 fixed lg:static h-screen z-40 transition-transform duration-300 ".concat(p?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:[(0,t.jsx)("div",{className:"px-6 py-5 border-b border-gray-100",children:(0,t.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-red-700 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,t.jsx)("span",{className:"text-white text-xs font-bold",children:"İR\xdc"})}),(0,t.jsx)("span",{className:"font-bold text-gray-800",children:"İR\xdcFoodFlow"})]})}),(0,t.jsx)("nav",{className:"flex-1 px-3 py-4 space-y-0.5",children:g.map(e=>{let a=m===e.path;return(0,t.jsx)(l.default,{href:e.path,className:"flex items-center px-4 py-2.5 rounded-xl text-sm transition-all ".concat(a?"bg-red-50 text-red-700 font-semibold":"text-gray-500 hover:bg-gray-100 hover:text-gray-800"),children:e.name},e.path)})}),(0,t.jsxs)("div",{className:"px-4 py-4 border-t border-gray-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,t.jsx)("div",{className:"w-9 h-9 bg-red-700 rounded-full flex items-center justify-center flex-shrink-0",children:(0,t.jsx)("span",{className:"text-white text-xs font-bold",children:y})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-gray-800 truncate",children:u.ad_soyad||u.username}),(0,t.jsx)("p",{className:"text-xs text-gray-400",children:u.role})]})]}),(0,t.jsx)("button",{onClick:()=>{localStorage.removeItem("aktifKullaniciId"),localStorage.removeItem("role"),localStorage.removeItem("username"),x.push("/")},className:"w-full text-sm text-red-600 hover:text-red-700 font-medium py-2 rounded-xl hover:bg-red-50 transition",children:"\xc7ıkış Yap"})]})]}),(0,t.jsxs)("main",{className:"flex-1 flex flex-col overflow-auto pt-16 lg:pt-0",children:[o&&(0,t.jsxs)("div",{className:"bg-red-700 text-white px-10 py-7 flex-shrink-0",children:[c&&(0,t.jsx)("p",{className:"text-red-300 text-xs font-medium uppercase tracking-widest mb-1",children:c}),(0,t.jsx)("h1",{className:"text-2xl font-bold",children:o})]}),(0,t.jsx)("div",{className:"flex-1 p-8",children:s})]})]})}},7951:function(e,a,s){"use strict";s.d(a,{a:function(){return n}});var t=s(8078),l=s(168);let r={"/admin":["admin"],"/kullanicilar":["admin"],"/dersler":["admin","bolum_baskani"],"/siparisler":["admin"],"/siparis-yonetimi":["admin"],"/urun-havuzu":["admin","ogretmen"],"/receteler":["admin","ogretmen"],"/bolum-baskani":["admin","bolum_baskani"],"/ogretmen":["admin","ogretmen"],"/alisveris-listelerim":["admin","ogretmen"],"/siparislerim":["admin","ogretmen"],"/talep":["admin","ogretmen"],"/satin":["admin","satin_alma"],"/stok":["admin","stok"]};function n(e){let a=(0,l.useRouter)(),[s,n]=(0,t.useState)(!1),[i,d]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{let s=localStorage.getItem("aktifKullaniciId"),t=localStorage.getItem("role");if(!s||!t){a.replace("/");return}let l=r[e];if(!l){n(!0),d(!1);return}l.includes(t)?(n(!0),d(!1)):a.replace({admin:"/admin",ogretmen:"/ogretmen",satin_alma:"/satin",stok:"/stok",bolum_baskani:"/bolum-baskani"}[t]||"/")},[e,a]),{yetkili:s,yukleniyor:i}}},9107:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return m}});var t=s(7821),l=s(8078),r=s(5561),n=s(7951),i=s(4786);let d=[{value:"ogretmen",label:"\xd6ğretmen"},{value:"admin",label:"Admin"},{value:"bolum_baskani",label:"B\xf6l\xfcm Başkanı"},{value:"satin_alma",label:"Satın Alma"},{value:"stok",label:"Stok"}],o={admin:"bg-rose-100 text-rose-700 border-rose-200",ogretmen:"bg-sky-100 text-sky-700 border-sky-200",bolum_baskani:"bg-purple-100 text-purple-700 border-purple-200",satin_alma:"bg-amber-100 text-amber-700 border-amber-200",stok:"bg-emerald-100 text-emerald-700 border-emerald-200"},c={username:"",ad_soyad:"",password_hash:"",role:"ogretmen",dersler:[]};function m(){let{yetkili:e,yukleniyor:a}=(0,n.a)("/kullanicilar");if(a)return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center text-gray-400",children:"Y\xfckleniyor..."});if(!e)return null;let[s,m]=(0,l.useState)("liste"),[x,u]=(0,l.useState)([]),[h,p]=(0,l.useState)([]),[b,g]=(0,l.useState)(c),[y,f]=(0,l.useState)(null),[j,v]=(0,l.useState)(""),[N,k]=(0,l.useState)(""),[w,_]=(0,l.useState)(!0);(0,l.useEffect)(()=>{S()},[]);let S=async()=>{_(!0);let[{data:e},{data:a}]=await Promise.all([i.O.from("kullanicilar").select("*").order("id"),i.O.from("dersler").select("*").order("kod")]);u(e||[]),p(a||[]),_(!1)},I=(e,a)=>{"basari"===e?(k(a),setTimeout(()=>k(""),3e3)):(v(a),setTimeout(()=>v(""),3e3))},C=async()=>{if(!b.username.trim()||!b.ad_soyad.trim()||!b.password_hash.trim()){I("hata","T\xfcm zorunlu alanları doldurun.");return}let{error:e}=await i.O.from("kullanicilar").insert({username:b.username.trim(),ad_soyad:b.ad_soyad.trim(),password_hash:b.password_hash,role:b.role,dersler:b.dersler});if(e){I("hata","Hata: "+e.message);return}I("basari",'"'.concat(b.ad_soyad,'" eklendi.')),g(c),S()},z=async()=>{if(!y)return;let e={ad_soyad:b.ad_soyad,role:b.role,dersler:b.dersler};b.password_hash&&(e.password_hash=b.password_hash);let{error:a}=await i.O.from("kullanicilar").update(e).eq("id",y);if(a){I("hata","Hata: "+a.message);return}I("basari","Kullanıcı g\xfcncellendi."),f(null),g(c),m("liste"),S()},A=async e=>{if(!confirm("Bu kullanıcıyı silmek istediğinizden emin misiniz?"))return;let{error:a}=await i.O.from("kullanicilar").delete().eq("id",e);if(a){I("hata","Hata: "+a.message);return}I("basari","Kullanıcı silindi."),S()},K=e=>{f(e.id),g({username:e.username,ad_soyad:e.ad_soyad,password_hash:"",role:e.role,dersler:e.dersler||[]}),m("guncelle")},E=e=>{g(a=>({...a,dersler:a.dersler.includes(e)?a.dersler.filter(a=>a!==e):[...a.dersler,e]}))},O="mt-1 w-full border border-gray-300 rounded-xl px-4 py-2.5 text-sm text-black placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-red-500";return(0,t.jsx)(r.Z,{title:"Kullanıcı & Erişim Y\xf6netimi",subtitle:"Sistemdeki personel ve kullanıcı bilgilerini y\xf6netin",children:(0,t.jsxs)("div",{className:"max-w-5xl space-y-5",children:[N&&(0,t.jsx)("div",{className:"bg-emerald-50 border border-emerald-200 text-emerald-700 text-sm rounded-xl px-4 py-3",children:N}),j&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 text-sm rounded-xl px-4 py-3",children:j}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden",children:[(0,t.jsx)("div",{className:"flex border-b border-gray-100",children:[{key:"liste",label:" Liste & Silme"},{key:"ekle",label:"+ Yeni Kullanıcı"},{key:"guncelle",label:" Veri G\xfcncelle"}].map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>m(e.key),className:"px-6 py-4 text-sm font-medium border-b-2 transition ".concat(s===e.key?"border-red-600 text-red-700":"border-transparent text-gray-500 hover:text-gray-700"),children:e.label},e.key))}),(0,t.jsxs)("div",{className:"p-6",children:["liste"===s&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-800",children:"Mevcut Kullanıcı Listesi"}),(0,t.jsxs)("span",{className:"text-xs bg-red-100 text-red-700 font-medium px-3 py-1 rounded-full",children:[x.length," Kullanıcı"]})]}),a?(0,t.jsx)("p",{className:"text-center text-gray-400 text-sm py-12",children:"Y\xfckleniyor..."}):0===x.length?(0,t.jsx)("p",{className:"text-center text-gray-400 text-sm py-12",children:"Hen\xfcz kullanıcı eklenmedi."}):(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-gray-50 border-b border-gray-100 text-left",children:[(0,t.jsx)("th",{className:"px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"ID"}),(0,t.jsx)("th",{className:"px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Kullanıcı Adı"}),(0,t.jsx)("th",{className:"px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Ad Soyad"}),(0,t.jsx)("th",{className:"px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Rol"}),(0,t.jsx)("th",{className:"px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider text-right",children:"İşlemler"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-50",children:x.map(e=>{var a,s,l;return(0,t.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,t.jsxs)("td",{className:"px-4 py-3 text-gray-400 font-mono text-xs",children:["#",e.id]}),(0,t.jsx)("td",{className:"px-4 py-3 font-semibold text-gray-800",children:e.username}),(0,t.jsx)("td",{className:"px-4 py-3 text-gray-600",children:e.ad_soyad||"—"}),(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsx)("span",{className:"text-xs font-medium px-2.5 py-0.5 rounded-full border ".concat(null!==(s=o[e.role])&&void 0!==s?s:"bg-gray-100 text-gray-600 border-gray-200"),children:null!==(l=null===(a=d.find(a=>a.value===e.role))||void 0===a?void 0:a.label)&&void 0!==l?l:e.role})}),(0,t.jsx)("td",{className:"px-4 py-3 text-right",children:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>K(e),className:"text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 font-medium px-3 py-1.5 rounded-lg transition",children:"D\xfczenle"}),(0,t.jsx)("button",{type:"button",onClick:()=>A(e.id),className:"text-xs bg-red-50 hover:bg-red-100 text-red-600 font-medium px-3 py-1.5 rounded-lg transition",children:"Sil"})]})})]},e.id)})})]})]}),"ekle"===s&&(0,t.jsxs)("div",{className:"space-y-4 max-w-2xl",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:"Yeni Kullanıcı Ekle"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-700",children:"Kullanıcı Adı *"}),(0,t.jsx)("input",{className:O,placeholder:"\xf6rn. enis.akici",value:b.username,onChange:e=>g(a=>({...a,username:e.target.value}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-700",children:"Ad Soyad *"}),(0,t.jsx)("input",{className:O,placeholder:"\xf6rn. Enis Edip AKICI",value:b.ad_soyad,onChange:e=>g(a=>({...a,ad_soyad:e.target.value}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-700",children:"Şifre *"}),(0,t.jsx)("input",{type:"password",className:O,placeholder:"••••••••",value:b.password_hash,onChange:e=>g(a=>({...a,password_hash:e.target.value}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-700",children:"Rol"}),(0,t.jsx)("select",{className:O+" bg-white",value:b.role,onChange:e=>g(a=>({...a,role:e.target.value})),children:d.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),"ogretmen"===b.role&&h.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-700",children:"Atanacak Dersler"}),(0,t.jsx)("div",{className:"mt-2 space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-xl p-3",children:h.map(e=>(0,t.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer hover:bg-gray-50 rounded-lg p-1",children:[(0,t.jsx)("input",{type:"checkbox",className:"accent-red-600",checked:b.dersler.includes(e.id),onChange:()=>E(e.id)}),(0,t.jsxs)("span",{className:"text-sm text-gray-700",children:[e.kod," - ",e.ad]})]},e.id))})]}),(0,t.jsx)("button",{type:"button",onClick:C,className:"mt-2 bg-red-700 hover:bg-red-800 text-white text-sm font-semibold px-6 py-2.5 rounded-xl transition",children:"Kullanıcı Ekle"})]}),"guncelle"===s&&(0,t.jsx)("div",{children:y?(0,t.jsxs)("div",{className:"space-y-4 max-w-2xl",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-800",children:"Kullanıcı D\xfczenle"}),(0,t.jsxs)("span",{className:"text-sm text-gray-400",children:["— ",b.username]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-700",children:"Ad Soyad *"}),(0,t.jsx)("input",{className:O,value:b.ad_soyad,onChange:e=>g(a=>({...a,ad_soyad:e.target.value}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-700",children:"Yeni Şifre (boş bırakılırsa değişmez)"}),(0,t.jsx)("input",{type:"password",className:O,placeholder:"••••••••",value:b.password_hash,onChange:e=>g(a=>({...a,password_hash:e.target.value}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-700",children:"Rol"}),(0,t.jsx)("select",{className:O+" bg-white",value:b.role,onChange:e=>g(a=>({...a,role:e.target.value})),children:d.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),"ogretmen"===b.role&&h.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-700",children:"Atanacak Dersler"}),(0,t.jsx)("div",{className:"mt-2 space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-xl p-3",children:h.map(e=>(0,t.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer hover:bg-gray-50 rounded-lg p-1",children:[(0,t.jsx)("input",{type:"checkbox",className:"accent-red-600",checked:b.dersler.includes(e.id),onChange:()=>E(e.id)}),(0,t.jsxs)("span",{className:"text-sm text-gray-700",children:[e.kod," - ",e.ad]})]},e.id))})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)("button",{type:"button",onClick:z,className:"bg-red-700 hover:bg-red-800 text-white text-sm font-semibold px-6 py-2.5 rounded-xl transition",children:"G\xfcncelle"}),(0,t.jsx)("button",{type:"button",onClick:()=>{f(null),m("liste")},className:"text-gray-500 text-sm border border-gray-200 px-6 py-2.5 rounded-xl hover:bg-gray-50 transition",children:"İptal"})]})]}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"G\xfcncellemek i\xe7in Liste sekmesinden bir kullanıcı se\xe7in."}),(0,t.jsx)("button",{type:"button",onClick:()=>m("liste"),className:"mt-3 text-red-600 text-sm font-medium hover:underline",children:"Listeye git →"})]})})]})]})]})})}},4786:function(e,a,s){"use strict";s.d(a,{O:function(){return t}});let t=(0,s(5674).eI)("https://dyqbddyenmrzjjhkperf.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR5cWJkZHllbm1yempqaGtwZXJmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE4NzU1MjcsImV4cCI6MjA4NzQ1MTUyN30.D83dK9y-GkVLYmfon94afTNGaffiZ1S1TCNy5Ug-Io4")}},function(e){e.O(0,[135,233,115,205,744],function(){return e(e.s=4810)}),_N_E=e.O()}]);